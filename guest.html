<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TheMoneyOlympics - Financial Literacy App</title>
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root {
            /* Light theme variables (default) */
            --bg-color: #f5f5f5;
            --app-bg: rgba(255, 255, 255, 0.95);
            --question-bg: rgba(240, 240, 240, 0.9);
            --text-color: #333333;
            --border-color: rgba(0, 0, 0, 0.2);
            --glow-color: rgba(0, 0, 0, 0.1);
            --inner-glow: rgba(0, 0, 0, 0.05);
            --header-bg: rgba(255, 255, 255, 0.3);
            --card-bg: rgba(255, 255, 255, 0.3);
            --accent-color: #85bb65;
            --accent-hover: rgba(133, 187, 101, 0.2);
            --overlay-bg: rgba(0, 0, 0, 0.5);
        }

        :root[data-theme="dark"] {
            /* Dark theme variables */
            --bg-color: #000000;
            --app-bg: rgba(64, 64, 64, 0.95);
            --question-bg: rgba(32, 32, 32, 0.9);
            --text-color: #ffffff;
            --border-color: rgba(255, 255, 255, 0.2);
            --glow-color: rgba(255, 255, 255, 0.15);
            --inner-glow: rgba(255, 255, 255, 0.1);
            --header-bg: rgba(64, 64, 64, 0.3);
            --card-bg: rgba(64, 64, 64, 0.3);
            --accent-color: #85bb65;
            --accent-hover: rgba(133, 187, 101, 0.2);
            --overlay-bg: rgba(0, 0, 0, 0.7);
        }

        body {
            background: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            font-family: Arial, sans-serif;
            transition: all 0.3s ease;
            position: relative;
            overflow-x: hidden;
        }

        .background-illustrations {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
            overflow: hidden;
        }

        .bg-element {
            position: absolute;
            border-radius: 50%;
            opacity: 0.25;
            transition: all 0.3s ease;
            filter: blur(50px);
            mix-blend-mode: screen;
            background: linear-gradient(45deg, rgba(255, 255, 255, 0.8), rgba(255, 255, 255, 0.95));
            box-shadow: 0 0 100px rgba(255, 255, 255, 0.4);
        }

        .bg-element:nth-child(1) {
            width: min(400px, 40vw);
            height: min(400px, 40vw);
            top: -15vh;
            left: -10vw;
            animation: float 25s infinite ease-in-out;
            opacity: 0.3;
        }

        .bg-element:nth-child(2) {
            width: min(300px, 35vw);
            height: min(300px, 35vw);
            bottom: -10vh;
            right: -10vw;
            animation: float 20s infinite ease-in-out reverse;
            opacity: 0.25;
        }

        .bg-element:nth-child(3) {
            width: min(250px, 30vw);
            height: min(250px, 30vw);
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            animation: float 30s infinite ease-in-out;
            opacity: 0.2;
        }

        @keyframes float {
            0%, 100% {
                transform: translate(0, 0) rotate(0deg) scale(1);
            }
            25% {
                transform: translate(min(100px, 8vw), min(100px, 8vh)) rotate(120deg) scale(1.1);
            }
            50% {
                transform: translate(0, min(200px, 15vh)) rotate(240deg) scale(1);
            }
            75% {
                transform: translate(min(-100px, -8vw), min(100px, 8vh)) rotate(360deg) scale(0.9);
            }
        }

        .app-container {
            background: var(--app-bg);
            border-radius: 20px;
            padding: 24px;
            width: min(90%, 600px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3),
                        0 0 30px var(--glow-color);
            position: relative;
            z-index: 1;
            margin: 20px auto;
            opacity: 0;
            animation: fadeIn 0.8s forwards;
            animation-delay: 0.2s;
        }

        .step-container {
            display: none;
            opacity: 0;
            transform: translateY(0) scale(0.98);
            transition: opacity 0.8s cubic-bezier(0.4, 0.0, 0.2, 1), 
                        transform 0.8s cubic-bezier(0.4, 0.0, 0.2, 1);
            position: absolute;
            width: 100%;
            left: 0;
            right: 0;
            padding: 10px;
            will-change: opacity, transform;
            backface-visibility: hidden;
        }

        .step-container.active {
            display: block;
            opacity: 1;
            transform: translateY(0) scale(1);
            position: relative;
            transition: opacity 0.8s cubic-bezier(0.4, 0.0, 0.2, 1), 
                        transform 0.8s cubic-bezier(0.4, 0.0, 0.2, 1);
        }

        .step-container.fade-out {
            opacity: 0;
            transform: translateY(0) scale(0.98);
            transition: opacity 0.6s cubic-bezier(0.4, 0.0, 0.2, 1), 
                        transform 0.6s cubic-bezier(0.4, 0.0, 0.2, 1);
        }

        .step-title {
            font-size: 2rem;
            color: var(--accent-color);
            margin-bottom: 1.5rem;
            text-align: center;
            font-weight: 600;
        }

        .step-description {
            font-size: 1.2rem;
            text-align: center;
            margin-bottom: 2rem;
            line-height: 1.5;
        }

        .option-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 2rem;
        }

        .option-item {
            display: flex;
            align-items: center;
            padding: 15px;
            background: var(--question-bg);
            border: 1px solid var(--border-color);
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .option-item:hover {
            background: var(--accent-hover);
            border-color: var(--accent-color);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        .option-item.selected {
            background: var(--accent-hover);
            border-color: var(--accent-color);
        }

        .option-checkbox {
            width: 20px;
            height: 20px;
            border: 2px solid var(--border-color);
            border-radius: 4px;
            margin-right: 12px;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: all 0.2s ease;
        }

        .option-item.selected .option-checkbox {
            background: var(--accent-color);
            border-color: var(--accent-color);
        }

        .option-item.selected .option-checkbox::after {
            content: "✓";
            color: white;
            font-size: 14px;
        }

        .option-label {
            font-size: 1.1rem;
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 2rem;
        }

        .nav-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            background: var(--question-bg);
            color: var(--text-color);
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .nav-btn:hover {
            background: var(--accent-hover);
        }

        .nav-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .nav-btn.next {
            background: var(--accent-color);
            color: white;
        }

        .nav-btn.prev {
            background: transparent;
            border: 1px solid var(--border-color);
        }

        .gold-button {
            display: none;
            margin: 1.5rem auto;
            padding: 12px 30px;
            background: linear-gradient(to bottom right, #FFD700, #B8860B);
            color: #000;
            font-size: 1.2rem;
            font-weight: bold;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(212, 175, 55, 0.4);
            transition: all 0.3s ease, opacity 0.5s ease;
            position: relative;
            overflow: hidden;
            text-align: center;
            width: fit-content;
            opacity: 0;
        }

        .gold-button::before {
            content: "";
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(
                to bottom right,
                rgba(255, 255, 255, 0.6),
                rgba(255, 255, 255, 0)
            );
            transform: rotate(30deg);
            opacity: 0.5;
            pointer-events: none;
            animation: shine 1.5s infinite;
        }

        .gold-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(212, 175, 55, 0.6);
        }

        @keyframes shine {
            0% {
                opacity: 0.5;
                left: -50%;
            }
            50% {
                opacity: 0.8;
            }
            100% {
                opacity: 0;
                left: 100%;
            }
        }

        /* Quiz - Updated to match index.html styling */
        .quiz-container {
            display: none;
            position: relative;
            z-index: 1;
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.5s ease, transform 0.5s ease;
        }

        .question-wrapper {
            position: relative;
            z-index: 1;
            background: var(--question-bg);
            color: var(--text-color);
            border-radius: 15px;
            padding: 20px;
            margin: 0 0 20px 0;
            transform-origin: center;
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }

        #question-text {
            color: var(--text-color);
            font-size: 1.5rem;
            margin: 0 0 20px 0;
            text-align: left;
        }

        #options-container {
            position: relative;
            z-index: 1;
            display: grid !important;
            grid-template-columns: repeat(2, 1fr) !important;
            grid-gap: 15px;
            margin-top: 20px;
            width: 100%;
            box-sizing: border-box;
        }

        .option-btn {
            position: relative;
            z-index: 1;
            background: var(--app-bg);
            color: var(--text-color);
            border: 1px solid var(--border-color);
            border-radius: 10px;
            padding: 15px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            text-align: left;
            width: 100%;
            box-sizing: border-box;
            overflow: hidden;
        }

        .option-btn:hover {
            background: var(--accent-hover);
            border-color: var(--accent-color);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }

        .option-btn:active {
            transform: translateY(1px);
        }

        .option-btn.correct {
            background: rgba(0, 128, 0, 0.7);
            border-color: #00ff00;
            animation: glow 1.5s infinite;
        }

        .option-btn.incorrect {
            background: rgba(128, 0, 0, 0.7);
            border-color: #ff0000;
            animation: shake 0.5s;
        }

        .option-btn::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.7) 0%, rgba(255,255,255,0) 70%);
            transform: translate(-50%, -50%) scale(0);
            opacity: 0;
            pointer-events: none;
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .option-btn:active::after {
            transform: translate(-50%, -50%) scale(1);
            opacity: 0.3;
            transition: 0s;
        }

        .progress-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .progress-text {
            font-size: 1.1rem;
            font-weight: 500;
        }

        #progress-bar {
            width: 100%;
            height: 6px;
            background-color: var(--border-color);
            border-radius: 3px;
            margin-bottom: 2rem;
            overflow: hidden;
        }
        
        #progress-indicator {
            height: 100%;
            background-color: var(--accent-color);
            width: 25%;
            transition: width 0.8s cubic-bezier(0.22, 1, 0.36, 1);
        }
        
        /* Add transition overlay for smooth page transitions */
        .page-transition-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: var(--accent-color);
            opacity: 0;
            pointer-events: none;
            z-index: 9999;
            transition: opacity 0.5s ease;
        }
        
        .page-transition-overlay.active {
            opacity: 1;
            pointer-events: all;
        }

        .feedback-container {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--app-bg);
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            z-index: 45;
            opacity: 0;
            visibility: hidden;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
            max-width: 90%;
            width: 450px;
        }

        .feedback-container.visible {
            opacity: 1;
            visibility: visible;
            animation: fadeInUp 0.5s;
        }

        .feedback-container.hidden {
            visibility: hidden;
            opacity: 0;
            display: none;
        }

        .feedback-message {
            font-size: 1.5rem;
            color: var(--text-color);
            margin-bottom: 15px;
            display: block;
        }

        .explanation {
            font-size: 1.1rem;
            color: var(--text-color);
            opacity: 0.8;
            margin-bottom: 20px;
            display: block;
        }

        #continue-btn {
            background: linear-gradient(45deg, #008000, #00a000);
            color: white;
            border: none;
            border-radius: 25px;
            padding: 12px 30px;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 20px;
            box-shadow: 0 4px 15px rgba(0, 128, 0, 0.3);
            display: block !important;
            width: auto;
            min-width: 200px;
            position: relative;
            z-index: 100;
            overflow: hidden;
        }

        #continue-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 128, 0, 0.4);
        }

        #continue-btn:active {
            transform: translateY(0);
            box-shadow: 0 2px 10px rgba(0, 128, 0, 0.2);
        }
        
        /* Page entry animation */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Mobile responsiveness */
        @media (max-width: 600px) {
            #options-container {
                grid-template-columns: 1fr !important;
            }
        }

        /* Add enhanced animations */
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            15%, 45%, 75% { transform: translateX(-10px); }
            30%, 60%, 90% { transform: translateX(10px); }
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeOutDown {
            from {
                opacity: 1;
                transform: translateY(0);
            }
            to {
                opacity: 0;
                transform: translateY(20px);
            }
        }

        @keyframes glow {
            0% { box-shadow: 0 0 5px rgba(0, 128, 0, 0.5); }
            50% { box-shadow: 0 0 20px rgba(0, 128, 0, 0.8); }
            100% { box-shadow: 0 0 5px rgba(0, 128, 0, 0.5); }
        }

        .question-exit {
            opacity: 0;
            transform: translateX(-50px);
        }

        .question-enter {
            opacity: 0;
            transform: translateX(50px);
        }

        .feedback-container.correct {
            border: 2px solid #00ff00;
        }

        .feedback-container.incorrect {
            border: 2px solid #ff0000;
        }

        .feedback-container.visible {
            opacity: 1;
            visibility: visible;
            animation: fadeInUp 0.5s;
        }

        /* Improve the shine animation for the continue button */
        #continue-btn::before {
            content: '';
            position: absolute;
            top: -100%;
            left: -100%;
            width: 50%;
            height: 300%;
            background: linear-gradient(
                to right,
                rgba(255, 255, 255, 0),
                rgba(255, 255, 255, 0.6),
                rgba(255, 255, 255, 0)
            );
            transform: rotate(30deg);
            animation: continueBtnShine 4s infinite;  /* Increased from 2s to 4s for slower animation */
            pointer-events: none;
        }

        /* Create a new animation specifically for the continue button */
        @keyframes continueBtnShine {
            0% {
                left: -100%;
            }
            30%, 100% {  /* Adjusted from 20% to 30% for a slower, more deliberate shine */
                left: 200%;
            }
        }

        /* Confetti canvas */
        #confetti-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1000;
        }

        /* Progress animation */
        .progress-fill-animation {
            transition: width 0.8s cubic-bezier(0.22, 1, 0.36, 1);
        }

        /* Add css for confetti fade out */
        @keyframes fadeOut {
            from {
                opacity: 1;
            }
            to {
                opacity: 0;
            }
        }

        .confetti-fade-out {
            animation: fadeOut 0.5s forwards;
        }

        /* Overlay styles */
        #overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--overlay-bg);
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            z-index: 40;
            pointer-events: none;
        }

        #overlay.active {
            opacity: 0.5;
            visibility: visible;
            pointer-events: auto;
            z-index: 9;
        }

        /* Add transition styles for questions */
        .slide-out-left {
            animation: slideOutLeft 0.5s forwards cubic-bezier(0.4, 0.0, 0.2, 1);
        }

        .slide-in-right {
            animation: slideInRight 0.5s forwards cubic-bezier(0.4, 0.0, 0.2, 1);
        }

        @keyframes slideOutLeft {
            from {
                transform: translateX(0);
                opacity: 1;
            }
            to {
                transform: translateX(-50px);
                opacity: 0;
            }
        }

        @keyframes slideInRight {
            from {
                transform: translateX(50px);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        /* Enhanced progress bar animation */
        .progress-indicator-animate {
            transition: width 0.6s cubic-bezier(0.22, 1, 0.36, 1);
        }

        /* Style for feedback messages */
        .step-feedback {
            min-height: 40px;
            margin-top: 20px;
            text-align: center;
            color: var(--accent-color);
            font-size: 1.1rem;
            font-weight: 500;
            opacity: 0;
            transform: translateY(10px);
            transition: opacity 0.3s ease, transform 0.3s ease;
        }
        
        .step-feedback.active {
            opacity: 1;
            transform: translateY(0);
        }
    </style>
</head>

<body>
    <div class="page-transition-overlay" id="page-transition"></div>
    
    <div class="background-illustrations">
        <div class="bg-element"></div>
        <div class="bg-element"></div>
        <div class="bg-element"></div>
    </div>

    <!-- Add confetti canvas -->
    <canvas id="confetti-canvas"></canvas>

    <div class="app-container">
        <div id="progress-bar">
            <div id="progress-indicator"></div>
        </div>

        <!-- Step 1 -->
        <div class="step-container active" id="step1">
            <h2 class="step-title">Why are you here?</h2>
            <p class="step-description">What's your money mission?</p>
            <div class="option-list">
                <div class="option-item" data-value="save_better">
                    <div class="option-checkbox"></div>
                    <span class="option-label">I want to save better</span>
                </div>
                <div class="option-item" data-value="stop_wasting">
                    <div class="option-checkbox"></div>
                    <span class="option-label">I want to stop wasting money</span>
                </div>
                <div class="option-item" data-value="build_habits">
                    <div class="option-checkbox"></div>
                    <span class="option-label">I want to build good habits early</span>
                </div>
                <div class="option-item" data-value="smarter_than_parents">
                    <div class="option-checkbox"></div>
                    <span class="option-label">I want to be smarter than my parents with money</span>
                </div>
                <div class="option-item" data-value="exploring">
                    <div class="option-checkbox"></div>
                    <span class="option-label">Just exploring</span>
                </div>
            </div>
            <!-- Add feedback message container -->
            <div id="step1-feedback" class="step-feedback"></div>
            <div class="navigation">
                <button class="nav-btn prev" disabled>Back</button>
                <button class="nav-btn next" id="next1" disabled>Next</button>
            </div>
        </div>

        <!-- Step 2 -->
        <div class="step-container" id="step2">
            <h2 class="step-title">How much time can you give it?</h2>
            <p class="step-description">No fluff. Just fast lessons that work.</p>
            <div class="option-list">
                <div class="option-item" data-value="casual">
                    <div class="option-checkbox"></div>
                    <span class="option-label">5 min a day (Casual)</span>
                </div>
                <div class="option-item" data-value="focused">
                    <div class="option-checkbox"></div>
                    <span class="option-label">10 min (Focused)</span>
                </div>
                <div class="option-item" data-value="olympian">
                    <div class="option-checkbox"></div>
                    <span class="option-label">15+ min (Olympian mode)</span>
                </div>
            </div>
            <!-- Add feedback message container -->
            <div id="step2-feedback" class="step-feedback"></div>
            <div class="navigation">
                <button class="nav-btn prev">Back</button>
                <button class="nav-btn next" id="next2" disabled>Next</button>
            </div>
        </div>

        <!-- Step 3 -->
        <div class="step-container" id="step3">
            <h2 class="step-title">Pick your starting point</h2>
            <p class="step-description">Money stuff at school? Never heard of it.</p>
            <div class="option-list">
                <div class="option-item" data-value="zero">
                    <div class="option-checkbox"></div>
                    <span class="option-label">I'm starting from zero</span>
                </div>
                <div class="option-item" data-value="some_knowledge">
                    <div class="option-checkbox"></div>
                    <span class="option-label">I know a bit already</span>
                </div>
                <div class="option-item" data-value="quiz">
                    <div class="option-checkbox"></div>
                    <span class="option-label">Let me take a short quiz and place me</span>
                </div>
            </div>
            <!-- Add feedback message container -->
            <div id="step3-feedback" class="step-feedback"></div>
            <div class="navigation">
                <button class="nav-btn prev">Back</button>
                <button class="nav-btn next" id="next3" disabled>Next</button>
            </div>
        </div>

        <!-- Step 4 -->
        <div class="step-container" id="step4">
            <h2 class="step-title">Start your first challenge</h2>
            <p class="step-description">You'll learn by doing. No boring lectures. Jump into your first challenge and start earning points for getting smarter.</p>
            <div id="letsgo-button-container" style="text-align: center;">
                <!-- Gold button will appear here after 2 seconds -->
            </div>
            <div class="navigation">
                <button class="nav-btn next" disabled style="visibility: hidden;">Next</button>
            </div>
        </div>

        <!-- New Quiz Container (Styled like index.html) -->
        <div class="quiz-container" id="quiz-container">
            <div class="progress-container">
                <span id="quiz-progress-text" class="progress-text">Question 1/6</span>
            </div>
            
            <div class="main-interface">
                <div id="current-question-container" class="question-wrapper">
                    <h2 id="question-text">What is compound interest?</h2>
                    <div id="options-container">
                        <!-- Options will be dynamically filled -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Feedback container - exactly like index.html -->
    <div id="overlay" class="overlay"></div>
    <div id="feedback-container" class="hidden">
        <p id="feedback-text"></p>
        <button id="continue-btn">Continue to Next Question 👍</button>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Add the index.html styles for feedback
            const feedbackStyles = document.createElement('style');
            feedbackStyles.textContent = `
                /* Overlay styles */
                #overlay {
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    background: var(--overlay-bg);
                    opacity: 0;
                    visibility: hidden;
                    transition: opacity 0.4s cubic-bezier(0.4, 0, 0.2, 1);
                    z-index: 40;
                    pointer-events: none;
                }

                #overlay.active {
                    opacity: 0.5;
                    visibility: visible;
                    pointer-events: auto;
                    z-index: 9;
                }

                #feedback-container {
                    position: fixed;
                    top: 50%;
                    left: 50%;
                    transform: translate(-50%, -50%);
                    background: var(--app-bg);
                    padding: 30px;
                    border-radius: 15px;
                    text-align: center;
                    z-index: 1001;
                    opacity: 0;
                    visibility: hidden;
                    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
                    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
                    display: flex;
                    flex-direction: column;
                    align-items: center;
                    gap: 20px;
                    max-width: 90%;
                    width: 400px;
                }

                #feedback-container.visible {
                    opacity: 1;
                    visibility: visible;
                }

                #feedback-container.hidden {
                    display: none;
                }

                #feedback-text {
                    font-size: 1.2rem;
                    color: var(--text-color);
                    margin-bottom: 10px;
                    display: block;
                }

                #continue-btn {
                    background: linear-gradient(45deg, #008000, #00a000);
                    color: white;
                    border: none;
                    border-radius: 25px;
                    padding: 12px 30px;
                    font-size: 1.1rem;
                    cursor: pointer;
                    transition: all 0.3s ease;
                    margin-top: 20px;
                    box-shadow: 0 4px 15px rgba(0, 128, 0, 0.3);
                    display: block;
                    width: auto;
                    min-width: 200px;
                }

                #continue-btn:hover {
                    transform: translateY(-2px);
                    box-shadow: 0 6px 20px rgba(0, 128, 0, 0.4);
                }

                #continue-btn:active {
                    transform: translateY(0);
                    box-shadow: 0 2px 10px rgba(0, 128, 0, 0.2);
                }
            `;
            document.head.appendChild(feedbackStyles);

            const steps = document.querySelectorAll('.step-container');
            const progressIndicator = document.getElementById('progress-indicator');
            const nextButtons = document.querySelectorAll('.nav-btn.next');
            const prevButtons = document.querySelectorAll('.nav-btn.prev');
            const optionItems = document.querySelectorAll('.option-item');
            const quizContainer = document.getElementById('quiz-container');
            const letsgoButtonContainer = document.getElementById('letsgo-button-container');
            const pageTransition = document.getElementById('page-transition');
            const confettiCanvas = document.getElementById('confetti-canvas');
            
            // Variables for quiz functionality
            let currentStep = 0;
            let currentQuestionIndex = 0;
            let correctAnswers = 0;
            let selectedOptions = {
                step1: null,
                step2: null,
                step3: null
            };
            let isProcessingAnswer = false;

            // Initialize confetti
            const confetti = {
                maxCount: 150,     // max particles
                speed: 2,          // particle speed factor
                frameInterval: 15, // render frame rate
                alpha: 1.0,        // particle alpha
                gradient: false,   // color gradient
                start: null        // start function
            };

            // Create a confetti animation
            confetti.start = function() {
                let context = confettiCanvas.getContext("2d");
                let width = window.innerWidth;
                let height = window.innerHeight;
                confettiCanvas.width = width;
                confettiCanvas.height = height;
                
                let particles = [];
                let particle;
                let angle = 0;
                
                // Create particles
                for (let i = 0; i < this.maxCount; i++) {
                    particle = {
                        x: Math.random() * width,
                        y: Math.random() * height - height,
                        r: 4 + Math.random() * 6,
                        d: Math.random() * this.maxCount,
                        color: randomColor(),
                        tilt: Math.floor(Math.random() * 10) - 10,
                        tiltAngleIncrement: Math.random() * 0.07 + 0.05,
                        tiltAngle: 0
                    };
                    particles.push(particle);
                }
                
                // Animation loop
                let animationTimer = null;
                function draw() {
                    if (!animationTimer) return;
                    
                    context.clearRect(0, 0, width, height);
                    
                    for (let i = 0; i < confetti.maxCount; i++) {
                        particle = particles[i];
                        context.beginPath();
                        context.lineWidth = particle.r / 2;
                        context.strokeStyle = particle.color;
                        context.moveTo(particle.x + particle.tilt + particle.r / 4, particle.y);
                        context.lineTo(particle.x + particle.tilt, particle.y + particle.r);
                        context.stroke();
                        
                        particle.tiltAngle += particle.tiltAngleIncrement;
                        particle.y += (Math.cos(angle) + 1 + particle.r / 10) * confetti.speed;
                        particle.tilt = 15 * Math.sin(particle.tiltAngle);
                        
                        // If particle is out of bounds, reset it
                        if (particle.y > height) {
                            if (i % 5 > 0 || i % 2 == 0) {
                                particles[i] = {
                                    x: Math.random() * width,
                                    y: -10,
                                    r: particle.r,
                                    d: particle.d,
                                    color: randomColor(),
                                    tilt: Math.floor(Math.random() * 10) - 10,
                                    tiltAngleIncrement: particle.tiltAngleIncrement,
                                    tiltAngle: particle.tiltAngle
                                };
                            } else {
                                // Fast-forward to a new position
                                particles[i] = {
                                    x: Math.random() * width,
                                    y: -10,
                                    r: particle.r,
                                    d: particle.d,
                                    color: randomColor(),
                                    tilt: Math.floor(Math.random() * 10) - 10,
                                    tiltAngleIncrement: particle.tiltAngleIncrement,
                                    tiltAngle: particle.tiltAngle
                                };
                            }
                        }
                    }
                    angle += 0.01;
                    
                    requestAnimationFrame(draw);
                }
                
                // Generate random color
                function randomColor() {
                    const colors = [
                        "#f44336", "#e91e63", "#9c27b0", "#673ab7", "#3f51b5",
                        "#2196f3", "#03a9f4", "#00bcd4", "#009688", "#4CAF50", 
                        "#8BC34A", "#CDDC39", "#FFEB3B", "#FFC107", "#FF9800", "#FF5722"
                    ];
                    return colors[Math.floor(Math.random() * colors.length)];
                }
                
                // Start animation
                animationTimer = requestAnimationFrame(draw);
                
                // Apply fadeout and stop after 2 seconds (reduced from 4 seconds)
                setTimeout(() => {
                    confettiCanvas.classList.add('confetti-fade-out');
                    setTimeout(() => {
                        cancelAnimationFrame(animationTimer);
                        animationTimer = null;
                        context.clearRect(0, 0, width, height);
                        confettiCanvas.classList.remove('confetti-fade-out');
                    }, 500); // 500ms fadeout
                }, 1500); // 1.5s active animation + 0.5s fadeout = 2s total
            };
            
            // Quiz questions data - Simplified version
            const quizQuestions = [
                {
                    question: "Which of these is a good way to save money?",
                    options: [
                        "Spending everything you earn",
                        "Creating a budget and sticking to it",
                        "Using credit cards for all purchases",
                        "Borrowing money from friends"
                    ],
                    correctIndex: 1,
                    explanation: "Creating and following a budget helps you track your money, spend less than you earn, and save regularly."
                },
                {
                    question: "What is a savings account for?",
                    options: [
                        "Buying stocks and bonds",
                        "Keeping money safe while earning some interest",
                        "Paying bills automatically",
                        "Getting a loan"
                    ],
                    correctIndex: 1,
                    explanation: "A savings account is a secure place to keep money you don't need right away, while earning a small amount of interest."
                },
                {
                    question: "Why is it important to save money?",
                    options: [
                        "To spend it all on vacations",
                        "To impress your friends",
                        "To have money for unexpected expenses",
                        "Because banks require it"
                    ],
                    correctIndex: 2,
                    explanation: "Saving money helps you handle unexpected expenses like car repairs or medical bills, and also build toward future goals."
                },
                {
                    question: "What is the difference between a want and a need?",
                    options: [
                        "They're the same thing",
                        "Wants are things you must have to survive, needs are optional",
                        "Needs are essential for survival, wants are things you'd like to have",
                        "Needs are cheaper than wants"
                    ],
                    correctIndex: 2,
                    explanation: "Needs are things essential for survival like food, shelter, and basic clothing. Wants are non-essential things that make life more enjoyable."
                },
                {
                    question: "What is interest?",
                    options: [
                        "Money you get for free",
                        "A fee you pay for borrowing money or money you earn for saving",
                        "A type of bank",
                        "Money that disappears over time"
                    ],
                    correctIndex: 1,
                    explanation: "Interest is either money you pay when you borrow money (like with a loan) or money you earn when you save or invest money (like in a savings account)."
                },
                {
                    question: "Which of these is NOT a good financial habit?",
                    options: [
                        "Saving a portion of your allowance or income",
                        "Tracking what you spend",
                        "Spending money as soon as you get it",
                        "Comparing prices before buying something"
                    ],
                    correctIndex: 2,
                    explanation: "Spending money immediately without planning is not a good financial habit. It's better to think about your purchases and save some of your money."
                }
            ];
            
            // Handle entry transition
            setTimeout(() => {
                if (pageTransition.classList.contains('active')) {
                    pageTransition.classList.remove('active');
                }
            }, 200);

            // Show the current step with luxury fade transitions
            function showStep(stepIndex) {
                // Handle transitions smoothly
                let activeStep = null;
                
                // Find the currently active step
                steps.forEach((step, index) => {
                    if (step.classList.contains('active')) {
                        activeStep = {index, element: step};
                    }
                });
                
                // If there is an active step (not initial load)
                if (activeStep) {
                    // Fade out current step with subtle scale
                    activeStep.element.classList.add('fade-out');
                    
                    // After a short delay, hide current and fade in next
                    setTimeout(() => {
                        activeStep.element.classList.remove('active', 'fade-out');
                        
                        // Start next step invisible
                        steps[stepIndex].style.opacity = '0';
                        steps[stepIndex].style.transform = 'translateY(0) scale(0.98)';
                        steps[stepIndex].classList.add('active');
                        
                        // Force reflow
                        void steps[stepIndex].offsetWidth;
                        
                        // Fade in next step
                        steps[stepIndex].style.opacity = '1';
                        steps[stepIndex].style.transform = 'translateY(0) scale(1)';
                        
                        // Update progress bar with elegant timing
                        progressIndicator.style.width = `${(stepIndex + 1) * 25}%`;
                        progressIndicator.classList.add('progress-fill-animation');
                    }, 500); // Slightly longer delay for luxury pacing
                }
                // Initial load (no animation needed)
                else {
                    steps.forEach((step, index) => {
                        if (index === stepIndex) {
                            step.classList.add('active');
                        } else {
                            step.classList.remove('active');
                        }
                    });
                    
                    // Update progress bar
                    progressIndicator.style.width = `${(stepIndex + 1) * 25}%`;
                }
                
                currentStep = stepIndex;
            }

            // Feedback message library
            const feedbackMessages = {
                step1: {
                    save_better: [
                        "Smart choice. Saving is the first flex.",
                        "That's a power move. Let's make it easy.",
                        "Brilliant start! Saving creates options.",
                        "Future you is already grateful.",
                        "Money saved = freedom earned."
                    ],
                    stop_wasting: [
                        "We'll turn those leaks into lakes.",
                        "Small changes, big impact. Let's go!",
                        "That money deserves better. You've got this.",
                        "Cutting waste = instant wealth.",
                        "This is how fortunes begin."
                    ],
                    build_habits: [
                        "Early habits = lifelong wealth.",
                        "You're ahead of 90% already.",
                        "Future millionaire move right there.",
                        "Small habits, massive results.",
                        "You'll thank yourself every day."
                    ],
                    smarter_than_parents: [
                        "Each generation levels up. Your turn.",
                        "New generation, new money rules.",
                        "Financial evolution starts with you.",
                        "Parents taught values, you'll master money.",
                        "Breaking the cycle starts here."
                    ],
                    exploring: [
                        "Curiosity creates wealth. Let's explore.",
                        "Best journeys start with exploration.",
                        "Perfect place to start. Let's discover.",
                        "Financial curiosity is step one to mastery.",
                        "Let's turn that curiosity into cash."
                    ]
                },
                step2: {
                    casual: [
                        "Perfect. Small daily wins add up.",
                        "5 minutes daily beats 5 hours monthly.",
                        "Consistency beats intensity. Good choice.",
                        "Bite-sized wisdom creates lasting wealth.",
                        "Small steps, big progress."
                    ],
                    focused: [
                        "The sweet spot of learning. Excellent!",
                        "10 minutes daily = expertise in months.",
                        "You'll be money-smart in no time.",
                        "Focused learning creates lasting results.",
                        "Goldilocks zone: just right for mastery."
                    ],
                    olympian: [
                        "Going for gold! Love the commitment.",
                        "Future financial champion in the making.",
                        "That's how wealth mastery happens.",
                        "Elite mindset leads to elite results.",
                        "Exceptional commitment = exceptional results."
                    ]
                },
                step3: {
                    zero: [
                        "Perfect place to start. Clean slate.",
                        "Starting from zero means no bad habits.",
                        "Beginners often learn faster. You've got this.",
                        "Fresh start, fresh perspective.",
                        "We'll build your foundation brick by brick."
                    ],
                    some_knowledge: [
                        "We'll build on what you know.",
                        "Great! You've got a running start.",
                        "Some knowledge + new skills = financial power.",
                        "We'll fill in the gaps and level you up.",
                        "That's a great foundation to build on."
                    ],
                    quiz: [
                        "Smart move. Let's find your perfect level.",
                        "Custom path coming right up!",
                        "We'll meet you exactly where you are.",
                        "Let's find your ideal starting point.",
                        "Let the journey fit your exact needs."
                    ]
                }
            };

            // Enhanced option selection with feedback
            optionItems.forEach(item => {
                item.addEventListener('click', function() {
                    const parent = this.parentElement;
                    const stepId = this.closest('.step-container').id;
                    const optionValue = this.dataset.value;
                    
                    // Remove selected class from all options in this step
                    parent.querySelectorAll('.option-item').forEach(opt => {
                        opt.classList.remove('selected');
                    });
                    
                    // Add selected class to clicked option with animation
                    this.classList.add('selected');
                    this.style.animation = 'pulse 0.3s forwards';
                    
                    // Reset animation after it completes
                    setTimeout(() => {
                        this.style.animation = '';
                    }, 300);
                    
                    // Store selection
                    selectedOptions[stepId] = optionValue;
                    
                    // Enable next button for this step
                    document.querySelector(`#${stepId} .nav-btn.next`).removeAttribute('disabled');
                    
                    // Show feedback message
                    const feedbackContainer = document.getElementById(`${stepId}-feedback`);
                    if (feedbackContainer && feedbackMessages[stepId] && feedbackMessages[stepId][optionValue]) {
                        // Get random message for this option
                        const messages = feedbackMessages[stepId][optionValue];
                        const randomMessage = messages[Math.floor(Math.random() * messages.length)];
                        
                        // Reset any existing feedback animation
                        feedbackContainer.classList.remove('active');
                        
                        // Force DOM reflow to restart animation
                        void feedbackContainer.offsetWidth;
                        
                        // Set new message and animate
                        feedbackContainer.textContent = randomMessage;
                        feedbackContainer.classList.add('active');
                    }
                });
            });

            // Next button functionality
            nextButtons.forEach((btn, index) => {
                btn.addEventListener('click', function() {
                    // Special handling for step 3 to step 4
                    if (index === 2) { // This is next3 button
                        if (selectedOptions.step3 === 'quiz') {
                            // The quiz will be shown after "Let's Go" button click
                            // Just proceed to step 4 as normal
                        }
                    }
                    
                    // Move to the next step
                    showStep(index + 1);
                    
                    // Special handling for step 4
                    if (index === 2) { // Moving to step 4
                        // Create and add the gold button immediately
                        const goldButton = document.createElement('button');
                        goldButton.className = 'gold-button';
                        goldButton.textContent = 'Let\'s Go';
                        goldButton.addEventListener('click', startQuiz);
                        letsgoButtonContainer.appendChild(goldButton);
                        
                        // Fade in the button immediately
                        goldButton.style.display = 'block';
                        setTimeout(() => {
                            goldButton.style.opacity = '1';
                            goldButton.style.animation = 'pulse 1.5s infinite';
                        }, 50); // Small delay to ensure display:block is applied
                    }
                });
            });

            // Previous button functionality
            prevButtons.forEach((btn, index) => {
                btn.addEventListener('click', function() {
                    // If we're in the quiz and going back
                    if (quizContainer.style.display === 'block') {
                        quizContainer.style.display = 'none';
                        showStep(2); // Go back to step 3
                        return;
                    }
                    
                    showStep(index - 1);
                });
            });

            // Load a quiz question with animation
            function loadQuestion(index) {
                const questionContainer = document.getElementById('current-question-container');
                const questionData = quizQuestions[index];
                
                // Add exit animation to current question - enhanced for smoothness
                questionContainer.classList.add('slide-out-left');
                
                setTimeout(() => {
                    // Update question content
                    document.getElementById('question-text').textContent = questionData.question;
                    document.getElementById('quiz-progress-text').textContent = `Question ${index + 1}/${quizQuestions.length}`;
                    
                    // Update progress indicator with animation
                    const progressPercent = ((index + 1) / quizQuestions.length) * 100;
                    const progressIndicator = document.getElementById('progress-indicator');
                    progressIndicator.classList.add('progress-indicator-animate');
                    progressIndicator.style.width = `${progressPercent}%`;
                    
                    // Add options with entrance animation
                    const optionsContainer = document.getElementById('options-container');
                    optionsContainer.innerHTML = '';
                    
                    questionData.options.forEach((option, optIndex) => {
                        const optionButton = document.createElement('button');
                        optionButton.className = 'option-btn';
                        optionButton.textContent = option;
                        optionButton.style.opacity = '0';
                        optionButton.style.transform = 'translateY(20px)';
                        optionButton.onclick = () => handleAnswer(optIndex, questionData.correctIndex, questionData.explanation);
                        optionsContainer.appendChild(optionButton);
                        
                        // Stagger the animation of each option
                        setTimeout(() => {
                            optionButton.style.transition = 'all 0.5s cubic-bezier(0.4, 0, 0.2, 1)';
                            optionButton.style.opacity = '1';
                            optionButton.style.transform = 'translateY(0)';
                        }, 100 + (optIndex * 50));
                    });
                    
                    // Remove exit animation and add entrance animation
                    questionContainer.classList.remove('slide-out-left', 'question-exit', 'question-enter');
                    questionContainer.classList.add('slide-in-right');
                    
                    // Force reflow
                    void questionContainer.offsetWidth;
                    
                }, 300);
            }
            
            // Handle quiz answer selection - index.html style
            function handleAnswer(selectedIndex, correctIndex, explanation) {
                console.log("handleAnswer called for", selectedIndex, correctIndex);
                
                if (isProcessingAnswer) return;
                isProcessingAnswer = true;
                
                const optionsContainer = document.getElementById('options-container');
                const selectedButton = optionsContainer.children[selectedIndex];
                const correctButton = optionsContainer.children[correctIndex];
                
                // Check if answer is correct
                const isCorrect = selectedIndex === correctIndex;
                console.log("Is answer correct?", isCorrect);
                
                // Play the appropriate sound based on whether the answer is correct or incorrect
                if (isCorrect) {
                    // Play correct sound
                    const correctSound = new Audio('assets/sounds/correct.mp3');
                    correctSound.play();
                    
                    // Play confetti for correct answer
                    confetti.start();
                    
                    selectedButton.classList.add('correct');
                    correctAnswers++;
                } else {
                    // Play incorrect sound
                    const incorrectSound = new Audio('assets/sounds/incorrect.mp3');
                    incorrectSound.play();
                    
                    selectedButton.classList.add('incorrect');
                    correctButton.classList.add('correct');
                }
                
                // Disable all option buttons
                Array.from(optionsContainer.children).forEach(button => {
                    button.disabled = true;
                });
                
                // Get direct references
                const feedbackText = document.getElementById('feedback-text');
                const overlay = document.getElementById('overlay');
                const feedbackContainer = document.getElementById('feedback-container');
                
                console.log("Feedback elements:", 
                    { feedbackText: !!feedbackText, overlay: !!overlay, feedbackContainer: !!feedbackContainer });
                
                // Set feedback text normally
                feedbackText.innerHTML = isCorrect ? 
                    `<strong>Correct!</strong><br><br>${explanation}` : 
                    `<strong>Incorrect</strong><br><br>${explanation}`;
                
                // Fix continue button visibility and enhance the shine effect
                const continueBtn = document.getElementById('continue-btn');
                continueBtn.style.opacity = "1";
                continueBtn.style.visibility = "visible";
                continueBtn.style.display = "block";
                continueBtn.style.overflow = "hidden"; // Ensure shine is contained
                
                console.log("Setting up to show feedback in 800ms");
                
                // Show overlay and feedback
                setTimeout(() => {
                    console.log("Showing feedback now");
                    overlay.classList.add('active');
                    feedbackContainer.classList.remove('hidden');
                    feedbackContainer.classList.add('visible');
                    
                    // Ensure feedback container is visible
                    feedbackContainer.style.display = "block";
                    feedbackContainer.style.visibility = "visible";
                    feedbackContainer.style.opacity = "1";
                }, 800);
            }
            
            // Continue to next question with enhanced transitions
            document.getElementById('continue-btn').addEventListener('click', function() {
                const overlay = document.getElementById('overlay');
                const feedbackContainer = document.getElementById('feedback-container');
                const questionContainer = document.getElementById('current-question-container');
                
                // Hide feedback
                overlay.classList.remove('active');
                feedbackContainer.classList.remove('visible');
                feedbackContainer.classList.add('hidden');
                
                // Force hide the feedback container through inline styles
                feedbackContainer.style.display = "none";
                feedbackContainer.style.visibility = "hidden";
                feedbackContainer.style.opacity = "0";
                
                // Add animation to current question
                questionContainer.classList.add('slide-out-left');
                
                setTimeout(() => {
                    isProcessingAnswer = false;
                    
                    // Move to next question or finish quiz
                    currentQuestionIndex++;
                    if (currentQuestionIndex < quizQuestions.length) {
                        loadQuestion(currentQuestionIndex);
                    } else {
                        finishQuiz();
                    }
                }, 300);
            });
            
            // Start the quiz with transition
            function startQuiz() {
                // Show transition effect
                pageTransition.classList.add('active');
                
                // Hide step containers after transition
                setTimeout(() => {
                    steps.forEach(step => {
                            step.classList.remove('active');
                    });
                    
                    // Show and fade in quiz container
                            quizContainer.style.display = 'block';
                    progressIndicator.style.width = '0%';
                    
                    // Load first question
                    currentQuestionIndex = 0;
                    correctAnswers = 0;
                    loadQuestion(currentQuestionIndex);
                    
                    // Complete the transition
                    setTimeout(() => {
                        pageTransition.classList.remove('active');
                            quizContainer.style.opacity = '1';
                            quizContainer.style.transform = 'translateY(0)';
                        }, 300);
                }, 500);
            }

            // Finish the quiz and redirect
            function finishQuiz() {
                // Show transition overlay
                pageTransition.classList.add('active');
                
                // Store user selections in localStorage for potential use in signup
                localStorage.setItem('userPreferences', JSON.stringify(selectedOptions));
                localStorage.setItem('quizScore', correctAnswers);
                localStorage.setItem('quizTotal', quizQuestions.length);
                
                // Special animation for completion
                if (correctAnswers >= 4) { // If they got at least 4 correct, show a big confetti celebration
                    confetti.start();
                }
                
                // Redirect after transition completes
                setTimeout(() => {
                    window.location.href = 'signup.html';
                }, 800);
            }

            // Initialize first step
            showStep(0);
            
            // Adjust for window resizing
            window.addEventListener('resize', function() {
                if (confettiCanvas) {
                    confettiCanvas.width = window.innerWidth;
                    confettiCanvas.height = window.innerHeight;
                }
            });

            // Add validation to ensure options are selected
            function validateStepSelection() {
                // Make sure all next buttons are disabled initially
                document.querySelectorAll('.nav-btn.next').forEach(btn => {
                    btn.disabled = true;
                });

                // Setup validation for each step
                const steps = ['step1', 'step2', 'step3'];
                steps.forEach(stepId => {
                    // Check if this step has a selected option on page load
                    const selectedOption = selectedOptions[stepId];
                    if (selectedOption) {
                        // If there's a selection, enable the next button
                        const nextBtn = document.querySelector(`#${stepId} .nav-btn.next`);
                        if (nextBtn) nextBtn.disabled = false;
                        
                        // Also visually select the option
                        const optionElement = document.querySelector(`#${stepId} .option-item[data-value="${selectedOption}"]`);
                        if (optionElement) optionElement.classList.add('selected');
                    }
                });
            }

            // Initialize validation after everything else is setup
            setTimeout(validateStepSelection, 100);
        });
    </script>
    <script src="js/navigation.js"></script>
</body>
</html> 
